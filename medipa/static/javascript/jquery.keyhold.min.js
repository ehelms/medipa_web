// (c)2010 Pablo Cuadrado

(function($){$.fn.keyHold=function(options){var keyTime=[];var settings={'lowpass':'400','highpass':'600'};return this.each(function(){if(options){$.extend(settings,options);}
$(this).keydown(function(e){if(!keyTime[e.keyCode]){keyTime[e.keyCode]=parseInt(e.timeStamp);console.log('Key '+e.keyCode+' pressed.');return true;}else{nDiff=(parseInt(e.timeStamp)-keyTime[e.keyCode]);if(nDiff>settings.highpass){$(this).trigger('keyheld');return false;}
e.preventDefault();e.stopPropagation();return false;}})
$(this).keyup(function(e){if(keyTime[e.keyCode]){nDiff=(parseInt(e.timeStamp)-keyTime[e.keyCode]);console.log('Key '+e.keyCode+' released after '+nDiff+'ms.');keyTime[e.keyCode]=false;if(nDiff<settings.lowpass){return true;}else{$(this).trigger('keyunhold');return false;}}})
$(this).blur(function(e){keyTime=[];console.log('Blurred.');})});};})(jQuery);